# **学習方法の実装状況と選択ガイド**

このドキュメントは、matsushibadenki/dora プロジェクトにおける各種学習アルゴリズムの実装状況を整理し、目的や制約に応じた適切な手法を選択するための指針を示します。

**更新情報 (2026-02-09):**

SARA Engine v7.4 の統合に伴い、Predictive Coding, Active Inference, および強化学習 (PPO) モジュールが大幅に強化されました。これらは現在、SARA Engineのエコシステムの一部として推奨されます。

## **1\. 実装状況一覧表**

現在の実装レベルを以下の3段階で分類しています。

* ✅ **Core**: 中核実装済み。動作確認が取れており、推奨される。  
* ⚠️ **Experimental**: 実験的実装。特定のモデルや条件下でのみ動作、または調整中。  
* ❌ **Draft**: 枠組みのみ。ファイルは存在するがロジックが未実装、または空の状態。

# **学習方法の実装状況と選択ガイド**

| カテゴリ | 学習手法 | 実装状況 | 主要ファイル (snn\_research/) | 推奨度 |
| :---- | :---- | :---- | :---- | :---- |
| **生体模倣** | **STDP** | ✅ Core | learning\_rules/stdp.py | ★★★ |
|  | **Hebbian / BCM** | ✅ Core | learning\_rules/bcm\_rule.py | ★★☆ |
| **代替BP** | **Forward-Forward** | ✅ Core | training/trainers/forward\_forward.py | ★★★ |
|  | **Predictive Coding** | ✅ **SARA** | models/experimental/predictive\_coding\_model.py | ★★★ |
| **自律制御** | **Active Inference** | ✅ **SARA** | learning\_rules/active\_inference.py | ★★★ |
|  | **Spike PPO** (RL) | ✅ **SARA** | training/rl/spike\_ppo.py | ★★★ |
|  | **Spike SAC** (RL) | ✅ **SARA** | training/rl/spike\_sac.py | ★★★ |
| **表現学習** | **Self-Supervised** | ✅ **SARA** | training/trainers/self\_supervised.py | ★★★ |

## **1-2\. 特記事項**

* **SARA統合の利点**: 全ての高度な学習（RL, AI, PC, SSL）が、同一の SARA Engine v7.4 バックエンド上で動作可能になりました。これにより、学習済み表現を異なるタスク間で共有することが容易になっています。  
* **SACの採用**: 連続値制御が必要なロボティクス等のタスクでは、従来のPPOに代わり、SARA統合版 SAC の利用を強く推奨します。
  
## **1-3\. SARA Engine 統合のメリット**

リファクタリングにより、主要な学習アルゴリズムが **SARA Engine v7.4** を基盤とする構成に統一されました。これには以下の利点があります：

1. **一貫した世界モデル**: Self-Supervised で学習した環境の内的モデルを、そのまま Active Inference や RL の特徴抽出器として共有できます。  
2. **時系列処理能力の向上**: SARAの再帰的構造（Recursive Architecture）により、過去の文脈を考慮した推論が全ての学習則で利用可能です。  
3. **高速な演算**: 内部ロジックの一部を Rust カーネル (dora\_kernel) に委譲することで、Python単体実装よりも高いスループットを実現します。
  
## **1-4\. アルゴリズムの使い分け指針**

* **ロボティクス・連続値制御**: Spike SAC を推奨。SARAの柔軟な表現力とSACの探索能力が最適に機能します。  
* **自律探索・ゴール達成**: Active Inference を推奨。「驚き（Free Energy）」の最小化プロセスがSARA内部で最適化されています。  
* **大規模データの事前学習**: Self-Supervised (SSL) を推奨。ラベルなしデータからSARAの基本回路を構築します。  
* **省メモリ・エッジデバイス**: Forward-Forward を推奨。BPを必要としないため、計算資源が限られた環境でも学習可能です。

  

## **2\. アルゴリズム選択フローチャート**

プロジェクトの要件に応じて、以下のフローチャートに従って最適な学習手法を選択してください。

graph TD  
    Start((開始)) \--\> Q1{ラベルデータは\<br\>ありますか？}

    Q1 \-- Yes \--\> Q2{計算リソースは\<br\>潤沢ですか？}  
    Q1 \-- No \--\> Q3{エージェントの\<br\>自律性が重要？}

    %% 教師あり学習の分岐  
    Q2 \-- Yes (GPUなど) \--\> BP\[Backpropagation\<br\>(surrogate gradient)\]  
    Q2 \-- No (Edge/CPU) \--\> FF\[Forward-Forward\]  
    Q2 \-- 知識蒸留したい \--\> KD\[Knowledge Distillation\]

    %% 教師なし/自律学習の分岐  
    Q3 \-- Yes \--\> Q3\_1{行動原理は？}  
    Q3 \-- No \--\> Q3\_2{特徴抽出のみ？}

    %% 自律エージェント系の分岐 (SARAへ集約)  
    Q3\_1 \-- 感情/自律性/記憶 \--\> SARA\[SARA Engine (Rust)\]  
    Q3\_1 \-- 報酬最大化 \--\> RL\[Spike PPO (via SARA)\]  
    Q3\_1 \-- 驚き最小化 \--\> AI\[Active Inference (via SARA)\]

    Q3\_2 \-- 生物学的妥当性 \--\> STDP\[STDP / Hebbian\]  
    Q3\_2 \-- 高度な表現 \--\> PC\[Predictive Coding (via SARA)\]

    %% 共通のゴール  
    PC \--\> End((決定))  
    PI \--\> End  
    FF \--\> End  
    KD \--\> End  
    BP \--\> End  
    SARA \--\> End  
    RL \--\> End  
    AI \--\> End  
    STDP \--\> End

## **3\. 各エンジンの詳細ガイド (Update)**

### **3.1 SARA Engine (Spiking Attractor Recursive Architecture)**

* **ステータス**: ✅ Core (v7.4 Integrated)  
* **特徴**:  
  * 短期記憶（再帰層）と長期記憶（アトラクタ）を統合したハイブリッドアーキテクチャ。  
  * Rustカーネル (dora\_kernel) による高速な並列演算をサポート。  
  * **統合バックエンド**: 以下の予測符号化、能動的推論、強化学習の基盤として機能します。  
* **推奨ユースケース**:  
  * DORAプロジェクトにおける汎用的な「脳」としての利用。  
  * マルチモーダル統合、文脈理解が必要なタスク。

### **3.2 Predictive Coding (予測符号化)**

* **ステータス**: ✅ Core (via SARA Engine)  
* **ファイル**: models/experimental/predictive\_coding\_model.py  
* **更新内容**:  
  * 内部ロジックを SARA Engine v7.4 に差し替えました。  
  * 従来の単機能モデルから、SARAの構造可塑性と記憶を利用した高度な予測モデルへ進化しました。  
  * use\_sara\_backend=True フラグでSARAモードが有効になります（デフォルト）。  
* **特徴**:  
  * トップダウンの予測信号とボトムアップの感覚入力の誤差（Prediction Error）を最小化します。  
  * SARAのAdapterを経由して、複雑な内部状態を単純なエラー値として取得可能。

### **3.3 Active Inference (能動的推論)**

* **ステータス**: ✅ Core (via SARA Engine)  
* **ファイル**: learning\_rules/active\_inference.py  
* **更新内容**:  
  * SARA Engine の推論ループへの委譲をサポートしました。  
  * ゴール状態（Preferred Observation）を与えることで、SARAが自律的に行動を生成します。  
* **特徴**:  
  * 「驚き（Free Energy）」を最小化するように、知覚の更新と行動の生成を同時に行います。  
  * 環境との相互作用が必要なロボティクス制御などに最適。

### **3.4 Spike PPO (強化学習)**

* **ステータス**: ✅ Core (via SARA Engine)  
* **ファイル**: training/rl/spike\_ppo.py  
* **更新内容**:  
  * SARAActorCritic クラスを追加。SARA Engine を Actor-Critic ネットワークとしてラップしました。  
  * SARAの持つ時系列記憶能力により、部分観測マルコフ決定過程（POMDP）への適応力が向上。  
* **特徴**:  
  * Proximal Policy Optimization アルゴリズムを用いた安定した強化学習。  
  * SARAの「思考」プロセスを行動確率（Actor）と状態価値（Critic）に変換。

### **3.5 Forward-Forward Algorithm**

* **ステータス**: ✅ Core  
* **ファイル**: training/trainers/forward\_forward.py  
* **特徴**:  
  * バックプロパゲーションを使わず、局所的な学習ルールのみで深層SNNを学習。  
  * メモリ効率が非常に良く、エッジデバイスやGPUメモリが限られた環境での学習に推奨。

### **3.6 STDP (Spike-Timing Dependent Plasticity)**

* **ステータス**: ✅ Core  
* **ファイル**: learning\_rules/stdp.py  
* **特徴**:  
  * 生物学的に最も妥当な学習則。  
  * 教師なしでの特徴抽出（エッジ検出など）や、初期重みの自己組織化に利用。

## **4\. 推奨される組み合わせ**

現在のコードベースにおいて、最も安定し、かつ高性能な組み合わせは以下の通りです。

1. **汎用エージェント (The "Brain")**:  
   * **Model**: SARA Engine (v7.4)  
   * **Training**: Spike PPO (報酬あり) or Active Inference (ゴールベース)  
2. **視覚・聴覚の特徴抽出**:  
   * **Model**: Spikformer or Hybrid CNN-SNN  
   * **Training**: Forward-Forward (事前学習) \+ STDP (微調整)  
3. **軽量エッジAI**:  
   * **Model**: BitSpikeLayer を用いた単純なSNN  
   * **Training**: \`Forward-Forward