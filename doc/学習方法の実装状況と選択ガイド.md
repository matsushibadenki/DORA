# **学習方法の実装状況と選択ガイド**

このドキュメントは、matsushibadenki/dora プロジェクトにおける各種学習アルゴリズムの実装状況を整理し、目的や制約に応じた適切な手法を選択するための指針を示します。

## **1\. 実装状況一覧表**

現在の実装レベルを以下の3段階で分類しています。

* ✅ **Core**: 中核実装済み。動作確認が取れており、推奨される。  
* ⚠️ **Experimental**: 実験的実装。特定のモデルや条件下でのみ動作、または調整中。  
* ❌ **Draft**: 枠組みのみ。ファイルは存在するがロジックが未実装、または空の状態。

| カテゴリ | 学習手法 | 実装状況 | 主要ファイル (snn\_research/) | 推奨度 | 用途 |
| :---- | :---- | :---- | :---- | :---- | :---- |
| **生体模倣** | **STDP** (Spike-Timing Dependent Plasticity) | ✅ Core | core/synapse\_dynamics.py learning\_rules/stdp.py | ★★★ | 教師なし学習、特徴抽出、自己組織化 |
|  | **Hebbian / BCM** | ✅ Core | learning\_rules/probabilistic\_hebbian.py learning\_rules/bcm\_rule.py | ★★☆ | 連想記憶、恒常性維持 |
| **代替BP** | **Forward-Forward** | ✅ Core | training/trainers/forward\_forward.py learning\_rules/forward\_forward.py | ★★★ | 深層SNNの省メモリ学習、エッジデバイス向け |
|  | **Predictive Coding** | ⚠️ Exp | models/experimental/predictive\_coding\_model.py | ★☆☆ | 生成モデル、異常検知、トップダウン予測 |
| **自律・感情** | **SARA Engine** (Integrated) | ✅ Core | models/experimental/sara\_engine.py models/adapters/sara\_adapter.py | ★★★ | **\[推奨\]** 汎用自律学習、長期記憶(アトラクタ)、Rust高速化、強化学習統合 |
|  | **Active Inference** | ⚠️ Exp | learning\_rules/active\_inference.py | ★★☆ | 不確実性下の意思決定、ロボット制御 |
|  | **Spike PPO / SAC** | ⚠️ Exp | training/rl/spike\_ppo.py | ★★☆ | 連続値制御、複雑なタスクの強化学習 |
| **モデル構造** | **Spikformer** | ✅ Core | models/transformer/spikformer.py | ★★★ | 大規模言語モデル、高精度な時系列処理 |
|  | **Visual Cortex** (SARA統合版) | ✅ Core | models/bio/visual\_cortex.py | ★★☆ | 視覚野模倣、物体認識、特徴抽出 |
|  | **Temporal SNN** (旧SimpleRSNN) | ✅ Core | models/bio/temporal\_snn.py | ★★☆ | 音声・心電図などの時系列データ処理 |

### **廃止・統合されたモデル**

* \~\~**Brain V4**\~\~: SARA Engineへ統合されました。  
* \~\~**Concept Brain**\~\~: SARA Engineのアトラクタ機能へ統合されました。  
* \~\~**LIF Neuron Legacy**\~\~: 標準LIFニューロンへ移行しました。

## **2\. 目的別・学習方法選択フローチャート**

迷ったときは以下のチャートに従ってアルゴリズムを選択してください。

graph TD  
    Start((開始)) \--\> Q1{教師データの有無は？}  
      
    %% 教師あり/なしの分岐  
    Q1 \-- Yes (教師あり) \--\> Q2{タスクの種類は？}  
    Q1 \-- No (教師なし/自己教師) \--\> Q3{環境からの報酬/FBはあるか？}

    %% 教師あり学習の分岐  
    Q2 \-- クラス分類/回帰 \--\> Q2\_1{制約条件は？}  
    Q2 \-- 生成/異常検知 \--\> PC\[Predictive Coding\]  
    Q2 \-- 物理制約あり \--\> PI\[Physics Informed Trainer\]

    Q2\_1 \-- メモリ制約あり \--\> FF\[Forward-Forward\]  
    Q2\_1 \-- モデル軽量化 \--\> KD\[Knowledge Distillation\]  
    Q2\_1 \-- 精度・速度バランス \--\> BP\[Surrogate Gradient BP\]  
      
    %% 教師なし/強化学習の分岐  
    Q3 \-- Yes (行動/制御) \--\> Q3\_1{制御の方針は？}  
    Q3 \-- No (パターン認識) \--\> Q3\_2{特徴抽出のアプローチ}

    %% 自律エージェント系の分岐 (SARAへ集約)  
    Q3\_1 \-- 感情/自律性/記憶 \--\> SARA\[SARA Engine (Rust)\]  
    Q3\_1 \-- 報酬最大化 \--\> RL\[Spike PPO / SAC\]  
    Q3\_1 \-- 驚き最小化 \--\> AI\[Active Inference\]

    Q3\_2 \-- 生物学的妥当性 \--\> STDP\[STDP / Hebbian\]  
    Q3\_2 \-- 高度な表現 \--\> SSL\[Self-Supervised\]

    %% 共通のゴール  
    PC \--\> End((決定))  
    PI \--\> End  
    FF \--\> End  
    KD \--\> End  
    BP \--\> End  
    SARA \--\> End  
    RL \--\> End  
    AI \--\> End  
    STDP \--\> End  
    SSL \--\> End

## **3\. 各エンジンの詳細ガイド**

### **3.1 SARA Engine (Spiking Attractor Recursive Architecture)**

* **ステータス**: ✅ Core (Rust Backend Available)  
* **特徴**:  
  * 短期記憶（再帰層）と長期記憶（アトラクタ）を統合したハイブリッドアーキテクチャ。  
  * Rustカーネル（dora\_kernel）による高速な並列演算をサポート。  
  * 報酬信号に基づくオンライン学習（RLM）を内蔵。  
* **推奨ユースケース**:  
  * 自律エージェントの脳  
  * 継続学習が必要なタスク（破滅的忘却の回避）  
  * 推論と学習を同時に行うリアルタイムシステム

### **3.2 Forward-Forward (FF)**

* **ステータス**: ✅ Core  
* **特徴**: 誤差逆伝播法（BP）を使わず、局所的な学習則のみで深層SNNを学習させる手法。メモリ使用量が極めて少ない。  
* **推奨ユースケース**:  
  * エッジデバイス（Raspberry Pi, Jetsonなど）でのオンデバイス学習  
  * GPUメモリが限られている環境

### **3.3 Spikformer (Spiking Transformer)**

* **ステータス**: ✅ Core  
* **特徴**: TransformerのSelf-Attention機構をスパイキングニューラルネットワークで実装。高い表現力を持つ。  
* **推奨ユースケース**:  
  * 自然言語処理（NLP）タスク  
  * 大規模な系列データ処理  
  * 高い精度が要求されるオフライン学習

### **3.4 Temporal SNN (Recurrent SNN)**

* **ステータス**: ✅ Core  
* **特徴**: シンプルな再帰結合を持つSNN。旧 SimpleRSNN をリファクタリングし、時系列データの処理に特化。  
* **推奨ユースケース**:  
  * センサーデータの異常検知  
  * 音声コマンド認識  
  * 軽量な時系列予測